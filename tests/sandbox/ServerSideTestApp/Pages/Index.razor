@page "/"
@using BlazorGenUI.Reflection.Enums
@using FestivalProject.BL.Models.FestivalDto
@using FestivalProject.BL.Models.StageDto
@using ServerSideTestApp.Services


<div class="p-5 mb-4 bg-light rounded-3 shadow">
    <div class="container-fluid py-5">
        <h1 class="display-5 fw-bold">Hello, world!</h1>
        <p class="col-md-8 fs-4">This is BlazorGenUI! An example app what is possible with BlazorGenUI framework.</p>
        <button class="btn btn-primary btn-lg" type="button" >Click me to generate UI!</button>
    </div>
</div>


@if (Festivals != null)
{
  
    <RenderableContentControl Context="@Pohoda" 
                              Presentation="PresentationType.Control"
                    
                              
    >
    </RenderableContentControl>

    <RenderableContentControl Context="@Stage" 
                              Presentation="PresentationType.Control"
    >
    </RenderableContentControl>
    
   

}

<button @onclick="Update">Save</button>

@if (GithubUser != null)
{
    <RenderableContentControl Context="@GithubUser" 
                              Presentation="PresentationType.Display"
                              IgnoredFields="Blog"
    >
    </RenderableContentControl>

    <p>@GithubUser.Name</p>
}
@if (Test != null)
{
    <RenderableContentControl Context="@Test"
                              Presentation="PresentationType.Control">
    </RenderableContentControl>
}

@code
{
    [Inject]
    public IFestivalService FestivalService {get; set; }
    [Inject]
    public IStageService StageService {get; set; }
    [Inject]
    public GitHubClient GitHubClient {get; set; }
    

    public IEnumerable<FestivalListDto> Festivals { get; set; }
    public StageDetailDto Stage { get; set; }
    public FestivalListDto Pohoda { get; set; }
    public TestClass Test { get; set; }

    private User GithubUser { get; set; }
    private void Update()
    {
        var test = Pohoda;
        var stage = Stage;
        
    }
    private Dictionary<string,string> CustomNames { get; set; }
    
    
    public bool IsChecked { get; set; }

    protected override async Task OnInitializedAsync()
    {
        GithubUser = await GitHubClient.User.Get("Specter-13");
        Festivals = (await FestivalService.GetFestivalList()).ToList();
        Stage = (await StageService.GetStageDetail());
        Pohoda = Festivals.First();
        Test = new TestClass {Generic = "This is generic UI element.", Boolean = false};
        CustomNames = new Dictionary<string, string>
        {
            {"Name", "Nazov festivalu:"},
            {"City", "Mesto:"}
        };
    }

    public class TestClass 
    {
      
        public string Generic { get; set; }
        public bool Boolean { get; set; }

    }
}