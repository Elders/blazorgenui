@page "/"
@using BlazorGenUI.Reflection.Enums
@using FestivalProject.BL.Models.FestivalDto
@using FestivalProject.BL.Models.StageDto
@using ObjectsClassLibrary
@using ServerSideTestApp.Services


<div class="p-5 mb-4 bg-light rounded-3 shadow">
    <div class="container-fluid py-5">
        <h1 class="display-5 fw-bold">Hello, world!</h1>
        <p class="col-md-8 fs-4">This is BlazorGenUI! An example app what is possible with BlazorGenUI framework.</p>
        <button class="btn btn-primary btn-lg" type="button" >Click me to generate UI!</button>
    </div>
</div>


@if (Festivals != null)
{
  
    <RenderableContentControl ContextBase="@Pohoda" 
                              Presentation="PresentationType.Control"
    >
    </RenderableContentControl>

    <RenderableContentControl ContextBase="@Pohoda" 
                              Presentation="PresentationType.Display"
    >
    </RenderableContentControl>
    
   

}

<button @onclick="Update">Save</button>

@if (GithubUser != null)
{
    <RenderableContentControl ContextBase="@GithubUser" 
                              Presentation="PresentationType.Display"
    >
    </RenderableContentControl>

    <p>@GithubUser.Name</p>
}


@code
{
    [Inject]
    public IFestivalService FestivalService {get; set; }
    [Inject]
    public IStageService StageService {get; set; }
    
    

    public IEnumerable<FestivalListDto> Festivals { get; set; }
    public StageDetailDto Stage { get; set; }
    public FestivalListDto Pohoda { get; set; }

    private User GithubUser { get; set; }
    private void Update()
    {
        var test = Pohoda;
        var stage = Stage;
        
    }

    
    public bool IsChecked { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var github = new GitHubClient(new ProductHeaderValue("BlazorGenUI"));
        GithubUser = await github.User.Get("Specter-13");
        Festivals = (await FestivalService.GetFestivalList()).ToList();
        Stage = (await StageService.GetStageDetail());
        Pohoda = Festivals.First();
    }


}